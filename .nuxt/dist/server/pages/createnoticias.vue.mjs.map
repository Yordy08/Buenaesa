{"version":3,"file":"createnoticias.vue.mjs","sources":["../../../../pages/createnoticias.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n\r\n    <br>\r\n    <br>\r\n    <br>\r\n\r\n    <!-- Overlay de cargando -->\r\n    <div v-if=\"cargando\" class=\"overlay-cargando\">\r\n      <div class=\"spinner\"></div>\r\n      <p>Creando noticia...</p>\r\n    </div>\r\n\r\n    <h1 class=\"titulo\">Gestión de Noticias</h1>\r\n\r\n    <!-- Formulario de noticias -->\r\n    <form @submit.prevent=\"subirNoticia\" class=\"formulario\">\r\n      <input type=\"text\" v-model=\"titulo\" placeholder=\"Título\" required />\r\n      <textarea v-model=\"descripcion\" placeholder=\"Descripción\" required></textarea>\r\n\r\n      <select v-model=\"categoria\" required>\r\n        <option value=\"\" disabled selected>Selecciona una categoría</option>\r\n        <option value=\"Emprendimiento\">Emprendimiento</option>\r\n        <option value=\"Ciencia e innovación\">Ciencia e innovación</option>\r\n        <option value=\"Cultura\">Cultura</option>\r\n        <option value=\"Personajes\">Personajes</option>\r\n        <option value=\"Ambiente\"> Ambiente\r\n          Paz y Convivencia</option>\r\n      </select>\r\n\r\n      <input type=\"file\" @change=\"manejarArchivo\" />\r\n\r\n      <button\r\n        type=\"submit\"\r\n        class=\"boton-enviar\"\r\n        :disabled=\"cargando\"\r\n      >\r\n        {{ editando ? 'Actualizar Noticia' : 'Crear Noticia' }}\r\n      </button>\r\n    </form>\r\n\r\n    <br>\r\n\r\n    <!-- Buscador -->\r\n    <input\r\n      type=\"text\"\r\n      v-model=\"busqueda\"\r\n      placeholder=\"Buscar noticias...\"\r\n      class=\"input-busqueda\"\r\n    />\r\n\r\n    <!-- Tabla de noticias -->\r\n    <div class=\"tabla-container\">\r\n      <table class=\"tabla\">\r\n        <thead>\r\n          <tr>\r\n            <th>Título</th>\r\n            <th>Descripción</th>\r\n            <th>Categoría</th>\r\n            <th>Imagen</th>\r\n            <th>Acciones</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"noticia in noticiasFiltradas\" :key=\"noticia._id\">\r\n            <td>{{ noticia.titulo }}</td>\r\n            <td>{{ noticia.descripcion }}</td>\r\n            <td>{{ noticia.categoria }}</td>\r\n            <td>\r\n              <img v-if=\"noticia.archivo\" :src=\"noticia.archivo\" class=\"imagen-noticia\" />\r\n            </td>\r\n            <td>\r\n              <button class=\"boton-editar\" @click=\"editarNoticia(noticia)\">Editar</button>\r\n              <button class=\"boton-eliminar\" @click=\"eliminarNoticia(noticia._id)\">Eliminar</button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport Swal from 'sweetalert2'\r\n\r\nconst titulo = ref('')\r\nconst descripcion = ref('')\r\nconst categoria = ref('')\r\nconst archivo = ref(null)\r\nconst noticias = ref([])\r\nconst editando = ref(false)\r\nconst noticiaEditando = ref(null)\r\nconst busqueda = ref('')\r\nconst cargando = ref(false)\r\n\r\nconst manejarArchivo = (e) => {\r\n  archivo.value = e.target.files[0]\r\n}\r\n\r\nonMounted(() => {\r\n  cargarNoticias()\r\n})\r\n\r\nconst cargarNoticias = async () => {\r\n  try {\r\n    const data = await $fetch('http://localhost:3001/api/noticias')\r\n    noticias.value = data\r\n  } catch (error) {\r\n    console.error(error)\r\n    Swal.fire('Error', 'No se pudieron cargar las noticias', 'error')\r\n  }\r\n}\r\n\r\nconst subirNoticia = async () => {\r\n  cargando.value = true\r\n  const formData = new FormData()\r\n  formData.append('titulo', titulo.value)\r\n  formData.append('descripcion', descripcion.value)\r\n  formData.append('categoria', categoria.value)\r\n  if (archivo.value) {\r\n    formData.append('archivo', archivo.value)\r\n  }\r\n\r\n  try {\r\n    if (editando.value) {\r\n      await $fetch(`http://localhost:3001/api/noticias/${noticiaEditando.value._id}`, {\r\n        method: 'PUT',\r\n        body: formData,\r\n      })\r\n      Swal.fire('Actualizado', 'La noticia se actualizó correctamente', 'success')\r\n    } else {\r\n      await $fetch('http://localhost:3001/api/noticias', {\r\n        method: 'POST',\r\n        body: formData,\r\n      })\r\n      Swal.fire('Creado', 'La noticia se creó correctamente', 'success')\r\n    }\r\n    limpiarFormulario()\r\n    cargarNoticias()\r\n  } catch (error) {\r\n    console.error(error)\r\n    Swal.fire('Error', 'Hubo un error al guardar la noticia', 'error')\r\n  } finally {\r\n    cargando.value = false\r\n  }\r\n}\r\n\r\nconst editarNoticia = (noticia) => {\r\n  titulo.value = noticia.titulo\r\n  descripcion.value = noticia.descripcion\r\n  categoria.value = noticia.categoria\r\n  noticiaEditando.value = noticia\r\n  editando.value = true\r\n}\r\n\r\nconst eliminarNoticia = async (id) => {\r\n  const confirmacion = await Swal.fire({\r\n    title: '¿Seguro que quieres eliminar esta noticia?',\r\n    icon: 'warning',\r\n    showCancelButton: true,\r\n    confirmButtonText: 'Sí, eliminar',\r\n    cancelButtonText: 'Cancelar'\r\n  })\r\n\r\n  if (confirmacion.isConfirmed) {\r\n    try {\r\n      await $fetch(`http://localhost:3001/api/noticias/${id}`, {\r\n        method: 'DELETE',\r\n      })\r\n      Swal.fire('Eliminado', 'La noticia ha sido eliminada', 'success')\r\n      cargarNoticias()\r\n    } catch (error) {\r\n      console.error(error)\r\n      Swal.fire('Error', 'No se pudo eliminar la noticia', 'error')\r\n    }\r\n  }\r\n}\r\n\r\nconst limpiarFormulario = () => {\r\n  titulo.value = ''\r\n  descripcion.value = ''\r\n  categoria.value = ''\r\n  archivo.value = null\r\n  noticiaEditando.value = null\r\n  editando.value = false\r\n}\r\n\r\nconst noticiasFiltradas = computed(() => {\r\n  return noticias.value.filter(noticia =>\r\n    noticia.titulo.toLowerCase().includes(busqueda.value.toLowerCase()) ||\r\n    noticia.descripcion.toLowerCase().includes(busqueda.value.toLowerCase()) ||\r\n    noticia.categoria.toLowerCase().includes(busqueda.value.toLowerCase())\r\n  )\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  max-width: 900px;\r\n  margin: auto;\r\n  padding: 20px;\r\n}\r\n\r\n.titulo {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.formulario input,\r\n.formulario textarea,\r\n.formulario select,\r\n.input-busqueda {\r\n  width: 100%;\r\n  padding: 10px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.boton-enviar {\r\n  width: 100%;\r\n  background-color: #007bff;\r\n  color: white;\r\n  border: none;\r\n  padding: 12px;\r\n  font-size: 16px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.boton-enviar:disabled {\r\n  background-color: #6c757d;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.tabla-container {\r\n  overflow-x: auto;\r\n  margin-top: 20px;\r\n}\r\n\r\n.tabla {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.tabla th, .tabla td {\r\n  border: 1px solid #ddd;\r\n  padding: 10px;\r\n  text-align: center;\r\n}\r\n\r\n.imagen-noticia {\r\n  width: 100px;\r\n  height: auto;\r\n}\r\n\r\n/* Botones de acciones */\r\n.boton-editar, .boton-eliminar {\r\n  margin: 2px;\r\n  padding: 8px 12px;\r\n  font-size: 14px;\r\n  cursor: pointer;\r\n  border: none;\r\n  border-radius: 5px;\r\n}\r\n\r\n.boton-editar {\r\n  background-color: #ffc107;\r\n  color: #000;\r\n}\r\n\r\n.boton-eliminar {\r\n  background-color: #dc3545;\r\n  color: #fff;\r\n}\r\n\r\n/* Overlay de cargando */\r\n.overlay-cargando {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0,0,0,0.6);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n  color: white;\r\n  font-size: 24px;\r\n}\r\n\r\n.spinner {\r\n  width: 50px;\r\n  height: 50px;\r\n  border: 6px solid #ccc;\r\n  border-top-color: #007bff;\r\n  border-radius: 50%;\r\n  animation: girar 1s linear infinite;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n@keyframes girar {\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n</style>\r\n"],"names":[],"mappings":";;;;;;;;AAsFA,UAAM,SAAS,IAAI,EAAE;AACrB,UAAM,cAAc,IAAI,EAAE;AAC1B,UAAM,YAAY,IAAI,EAAE;AACR,QAAI,IAAI;AACxB,UAAM,WAAW,IAAI,EAAE;AACvB,UAAM,WAAW,IAAI,KAAK;AACF,QAAI,IAAI;AAChC,UAAM,WAAW,IAAI,EAAE;AACvB,UAAM,WAAW,IAAI,KAAK;AA8F1B,UAAM,oBAAoB,SAAS,MAAM;AACvC,aAAO,SAAS,MAAM;AAAA,QAAO,aAC3B,QAAQ,OAAO,YAAa,EAAC,SAAS,SAAS,MAAM,aAAa,KAClE,QAAQ,YAAY,YAAa,EAAC,SAAS,SAAS,MAAM,aAAa,KACvE,QAAQ,UAAU,YAAa,EAAC,SAAS,SAAS,MAAM,aAAa;AAAA,MACtE;AAAA,IACH,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}