import{_ as T,r as l,g as _,z as $,c,a as e,j as w,q as f,v as g,A,m as B,t as b,p as D,F as V,k as z,o as d}from"./CrcHS_TD.js";import{S as i}from"./B0Dix5B2.js";const F={class:"container"},P={key:0,class:"overlay-cargando"},U=["disabled"],j={class:"tabla-container"},M={class:"tabla"},I=["src"],G=["onClick"],H=["onClick"],O={__name:"createnoticias",setup(J){const n=l(""),r=l(""),s=l(""),v=l(null),y=l([]),p=l(!1),C=l(null),u=l(""),m=l(!1),E=t=>{v.value=t.target.files[0]};_(()=>{h()});const h=async()=>{try{const t=await $fetch("http://localhost:3001/api/noticias");y.value=t}catch(t){console.error(t),i.fire("Error","No se pudieron cargar las noticias","error")}},N=async()=>{m.value=!0;const t=new FormData;t.append("titulo",n.value),t.append("descripcion",r.value),t.append("categoria",s.value),v.value&&t.append("archivo",v.value);try{p.value?(await $fetch(`http://localhost:3001/api/noticias/${C.value._id}`,{method:"PUT",body:t}),i.fire("Actualizado","La noticia se actualizó correctamente","success")):(await $fetch("http://localhost:3001/api/noticias",{method:"POST",body:t}),i.fire("Creado","La noticia se creó correctamente","success")),S(),h()}catch(a){console.error(a),i.fire("Error","Hubo un error al guardar la noticia","error")}finally{m.value=!1}},L=t=>{n.value=t.titulo,r.value=t.descripcion,s.value=t.categoria,C.value=t,p.value=!0},k=async t=>{if((await i.fire({title:"¿Seguro que quieres eliminar esta noticia?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await $fetch(`http://localhost:3001/api/noticias/${t}`,{method:"DELETE"}),i.fire("Eliminado","La noticia ha sido eliminada","success"),h()}catch(o){console.error(o),i.fire("Error","No se pudo eliminar la noticia","error")}},S=()=>{n.value="",r.value="",s.value="",v.value=null,C.value=null,p.value=!1},x=$(()=>y.value.filter(t=>t.titulo.toLowerCase().includes(u.value.toLowerCase())||t.descripcion.toLowerCase().includes(u.value.toLowerCase())||t.categoria.toLowerCase().includes(u.value.toLowerCase())));return(t,a)=>(d(),c("div",F,[a[7]||(a[7]=e("br",null,null,-1)),a[8]||(a[8]=e("br",null,null,-1)),a[9]||(a[9]=e("br",null,null,-1)),m.value?(d(),c("div",P,a[4]||(a[4]=[e("div",{class:"spinner"},null,-1),e("p",null,"Creando noticia...",-1)]))):w("",!0),a[10]||(a[10]=e("h1",{class:"titulo"},"Gestión de Noticias",-1)),e("form",{onSubmit:D(N,["prevent"]),class:"formulario"},[f(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>n.value=o),placeholder:"Título",required:""},null,512),[[g,n.value]]),f(e("textarea",{"onUpdate:modelValue":a[1]||(a[1]=o=>r.value=o),placeholder:"Descripción",required:""},null,512),[[g,r.value]]),f(e("select",{"onUpdate:modelValue":a[2]||(a[2]=o=>s.value=o),required:""},a[5]||(a[5]=[B('<option value="" disabled selected data-v-85d81f6e>Selecciona una categoría</option><option value="Emprendimiento" data-v-85d81f6e>Emprendimiento</option><option value="Ciencia e innovación" data-v-85d81f6e>Ciencia e innovación</option><option value="Cultura" data-v-85d81f6e>Cultura</option><option value="Personajes" data-v-85d81f6e>Personajes</option><option value="Ambiente" data-v-85d81f6e> Ambiente Paz y Convivencia</option>',6)]),512),[[A,s.value]]),e("input",{type:"file",onChange:E},null,32),e("button",{type:"submit",class:"boton-enviar",disabled:m.value},b(p.value?"Actualizar Noticia":"Crear Noticia"),9,U)],32),a[11]||(a[11]=e("br",null,null,-1)),f(e("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=o=>u.value=o),placeholder:"Buscar noticias...",class:"input-busqueda"},null,512),[[g,u.value]]),e("div",j,[e("table",M,[a[6]||(a[6]=e("thead",null,[e("tr",null,[e("th",null,"Título"),e("th",null,"Descripción"),e("th",null,"Categoría"),e("th",null,"Imagen"),e("th",null,"Acciones")])],-1)),e("tbody",null,[(d(!0),c(V,null,z(x.value,o=>(d(),c("tr",{key:o._id},[e("td",null,b(o.titulo),1),e("td",null,b(o.descripcion),1),e("td",null,b(o.categoria),1),e("td",null,[o.archivo?(d(),c("img",{key:0,src:o.archivo,class:"imagen-noticia"},null,8,I)):w("",!0)]),e("td",null,[e("button",{class:"boton-editar",onClick:q=>L(o)},"Editar",8,G),e("button",{class:"boton-eliminar",onClick:q=>k(o._id)},"Eliminar",8,H)])]))),128))])])])]))}},R=T(O,[["__scopeId","data-v-85d81f6e"]]);export{R as default};
